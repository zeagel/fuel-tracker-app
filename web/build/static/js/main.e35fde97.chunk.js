(this["webpackJsonpfuel-tracker-fe"]=this["webpackJsonpfuel-tracker-fe"]||[]).push([[0],{292:function(e,t,a){e.exports=a(501)},318:function(e,t,a){},395:function(e,t,a){e.exports=a.p+"static/media/logo-gasoline-pump.288449a9.png"},428:function(e,t,a){},441:function(e,t,a){},498:function(e,t,a){},499:function(e,t,a){},501:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(35),l=a.n(i),c=a(13),o=a(37),u=a(78),s=a(261),m=a(262),d=a(8),f=a.n(d),v=a(14),p=a(140),E=a(26),h=a.n(E),b=null,k=function(){return b},g={login:function(){var e=Object(v.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),verifyPwd:function(){var e=Object(v.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:k()}},e.prev=1,e.next=4,h.a.post("".concat("/api/login","/verify"),t,a);case 4:return e.abrupt("return",!0);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){return b="bearer ".concat(e)},getToken:k,decodeToken:function(){return Object(p.a)(b)}},j=function(){var e=window.setTimeout((function(){for(var t=e;t>=0;t--)window.clearInterval(t)}),0)},y=function(e){return function(){var t=Object(v.a)(f.a.mark((function t(a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:j(),setTimeout((function(){a(O())}),1e3*e.timeout),a({type:"SET_NOTIFICATION",data:{notification:e}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},O=function(){return function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j(),t({type:"CLEAR_NOTIFICATION",data:null});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.data.notification;case"CLEAR_NOTIFICATION":return null;default:return e}},N=a(55),x={getSimpleUserList:function(){var e=Object(v.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:g.getToken()}},e.next=3,h.a.get("".concat("/api/users","/simple"),t);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getUserById:function(){var e=Object(v.a)(f.a.mark((function e(){var t,a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:g.getToken()}},a=g.decodeToken(),e.next=4,h.a.get("".concat("/api/users","/").concat(a.id),t);case 4:return n=e.sent,e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),addUser:function(){var e=Object(v.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/users",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateUser:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:g.getToken()}},n=g.decodeToken(),e.next=4,h.a.put("".concat("/api/users","/").concat(n.id,"/update"),t,a);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),removeUser:function(){var e=Object(v.a)(f.a.mark((function e(){var t,a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:g.getToken()}},a=g.decodeToken(),e.next=4,h.a.delete("".concat("/api/users","/").concat(a.id),t);case 4:return n=e.sent,e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},C={addVehicle:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:g.getToken()}},e.next=3,h.a.post("/api/vehicles",t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateVehicle:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:g.getToken()}},e.next=3,h.a.put("".concat("/api/vehicles","/").concat(t.vehicle.id,"/update"),t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),removeVehicle:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:g.getToken()}},e.next=3,h.a.delete("".concat("/api/vehicles","/").concat(t),a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S={addRefueling:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:g.getToken()}},e.next=3,h.a.post("/api/refuelings",t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateRefueling:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:g.getToken()}},e.next=3,h.a.put("".concat("/api/refuelings","/").concat(t.refueling.id,"/update"),t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),removeRefueling:function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:g.getToken()}},e.next=3,h.a.delete("".concat("/api/refuelings","/").concat(t),a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},T=a(74),A=function(e){return function(t){t({type:"UPDATE_LIST_STATE",data:e})}},I=function(e){return function(t){t({type:"REMOVE_FROM_LIST_STATES",data:e})}},_=function(e){return function(t){t({type:"ADD_IN_LIST_STATES",data:e})}},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_LIST_STATES":return t.data;case"TOGGLE_LIST_STATE":var a=e.map((function(e){return e.id===t.data?Object(N.a)(Object(N.a)({},e),{},{state:"open"===e.state?"closed":"open"}):e}));return a;case"UPDATE_LIST_STATE":var n=e.map((function(e){return e.id===t.data.id?t.data:e}));return n;case"REMOVE_FROM_LIST_STATES":var r=e.filter((function(e){return e.id!==t.data?e:null}));return r;case"ADD_IN_LIST_STATES":var i=Object(T.a)(e);return i.push(t.data),i;default:return e}},D=function(e){return function(){var t=Object(v.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.updateVehicle(e);case 3:n=t.sent,a({type:"UPDATE_USER_VEHICLE",data:{vehicle:n.vehicle,primary:n.primary}}),a(A({id:n.vehicle.id,state:n.primary?"open":"closed"})),a(y({type:"info",header:void 0,content:"Ajoneuvo ".concat(n.vehicle.name," (").concat(n.vehicle.licensePlateId,") p\xe4ivitetty onnistuneesti."),timeout:3.5})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a(y({type:"error",header:void 0,content:"Odottamaton virhe ajoneuvon p\xe4ivityksess\xe4. Yrit\xe4 my\xf6hemmin uudelleen.",timeout:3.5}));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USER":return t.data;case"ADD_VEHICLE_TO_USER":var a=Object(N.a)({},e);return a.vehicles.push(t.data.vehicle),a.primaryVehicle=t.data.primary,a;case"UPDATE_USER_VEHICLE":var n=Object(N.a)({},e);return n.vehicles=e.vehicles.map((function(e){return e.id!==t.data.vehicle.id?e:t.data.vehicle})),n.primaryVehicle=t.data.primary,n;case"ADD_REFUELING":var r=Object(N.a)({},e);return r.vehicles=e.vehicles.map((function(e){return e.id===t.data.entry.vehicle.id&&("addEnd"===t.data.type&&(e.odoMeter=t.data.entry.odoMeter),e.refuelings.push(t.data.entry)),e})),r;case"REMOVE_VEHICLE_FROM_USER":var i=Object(N.a)({},e),l=e.vehicles.findIndex((function(e){return e.id===t.data.vehicle.id}));return i.vehicles.splice(l,1),i.primaryVehicle=t.data.primary,i;case"UPDATE_USER_REFUELING_ENTRY":var c=Object(N.a)({},e),o=e.vehicles.find((function(e){return e.id===t.data.updatedEntry.vehicle.id}));return o.refuelings=o.refuelings.map((function(e){return e.id===t.data.updatedEntry.id?t.data.updatedEntry:e})),t.data.vehicleOdoUpdated&&(o.odoMeter=t.data.updatedEntry.odoMeter),c.vehicles=c.vehicles.map((function(e){return e.id===o.id?o:e})),c;case"REMOVE_REFUELING_FROM_USER":var u=Object(N.a)({},e);return u.vehicles=u.vehicles.map((function(e){if(e.id===t.data.removedRefuelingEntry.vehicle){var a=e.refuelings.findIndex((function(e){return e.id===t.data.removedRefuelingEntry.id}));return e.refuelings.splice(a,1),t.data.vehicleOdoUpdated&&(e.odoMeter=e.odoMeter-t.data.removedRefuelingEntry.tripKilometers),e}return e})),u;default:return e}},U=function(e){return function(){var t=Object(v.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.login(e);case 3:n=t.sent,a({type:"LOGIN_USER",data:n.token}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a(y({type:"error",header:"Kirjautuminen ep\xe4onnistui",content:"Virheellinen k\xe4ytt\xe4j\xe4tunnus tai salasana",timeout:3.5}));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},P=function(){return function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"LOGOUT_USER",data:null});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_USER":return window.localStorage.setItem("loggedFTAUser",JSON.stringify(t.data)),g.setToken(t.data),window.location.href="/",t.data;case"LOGOUT_USER":return window.localStorage.removeItem("loggedFTAUser"),window.localStorage.removeItem("currentFTAPage"),window.location.href="/",null;default:return e}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS_LIST":return t.data;default:return e}},F=function(e){return function(t){t({type:"UPDATE_ACTIVE_ITEM",data:e})}},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_ACTIVE_ITEM":var a=window.localStorage.getItem("currentFTAPage");return a||t.data;case"UPDATE_ACTIVE_ITEM":return window.localStorage.setItem("currentFTAPage",t.data),t.data;default:return e}},z=function(e){return function(t){t({type:"SET_REFUELING_ENTRY",data:e})}},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_REFUELING_ENTRY":case"RESET_REFUELING_ENTRY":return t.data;default:return e}},H=Object(u.combineReducers)({login:V,note:w,user:M,users:L,navi:K,refueling:G,listStates:R}),B=Object(u.createStore)(H,Object(m.composeWithDevTools)(Object(u.applyMiddleware)(s.a))),Y=a(19),$=a(10),W=a(520),J=a(521),Z=a(280),q=a(516),Q=a(522),X=a(506),ee=a(518),te=a(83),ae=(a(318),function(){var e=Object(c.c)((function(e){return e.note}));return r.a.createElement(ee.a,{color:"info"===e.type?"green":"red"},e.header?r.a.createElement("div",{className:"note-header"},e.header):null,r.a.createElement("div",null,e.content))}),ne=a(395),re=function(e){var t=Object(n.useState)(""),a=Object($.a)(t,2),i=a[0],l=a[1],u=Object(n.useState)(""),s=Object($.a)(u,2),m=s[0],d=s[1],p=Object(c.c)((function(e){return e.note})),E=Object(c.b)(),h=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),E(U({user:{username:i,password:m}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(W.a,{textAlign:"center",style:{height:"65vh"},verticalAlign:"middle"},r.a.createElement(W.a.Column,{style:{maxWidth:450}},r.a.createElement(J.a,{as:"h2",color:"orange",textAlign:"center"},r.a.createElement(Z.a,{src:ne})," Tankkitutka"),r.a.createElement(q.a,{size:"large",onSubmit:h},r.a.createElement(Q.a,{raised:!0},r.a.createElement(q.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"K\xe4ytt\xe4j\xe4tunnus",onChange:function(e){l(e.target.value)}}),r.a.createElement(q.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Salasana",type:"password",onChange:function(e){d(e.target.value)}}),r.a.createElement(X.a,{type:"submit",color:"orange",fluid:!0,size:"large"},"Kirjaudu"))),r.a.createElement(ee.a,null,"Ei tunnusta viel\xe4?",r.a.createElement(o.b,{to:"/register",onClick:function(){return E(O())}}," Rekister\xf6idy")),r.a.createElement(ee.a,{icon:!0,color:"yellow"},r.a.createElement(te.a,{name:"warning sign"}),r.a.createElement(ee.a.Content,{style:{textAlign:"left"}},r.a.createElement(ee.a.Header,null,"Huomio!"),"T\xe4m\xe4 on testisovellus! Sovelluksen tiedot nollataan aika ajoin ilman ennakkovaroitusta.")),p?r.a.createElement(ae,null):null))},ie=a(519),le=(a(428),function(e){var t=e.userName,a=Object(c.c)((function(e){return e.navi})),i=Object(c.b)();Object(n.useEffect)((function(){var e;a||i((e="/refueling-list",function(t){t({type:"INIT_ACTIVE_ITEM",data:e})}))}),[a,i]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ie.a,{pointing:!0,secondary:!0},r.a.createElement(ie.a.Item,{as:o.c,to:"/refueling-list",position:"left",className:"menu-item-spacing",active:"/refueling-list"===a,onClick:function(){i(F("/refueling-list")),i(O())}},r.a.createElement(te.a,{name:"car"}),"Tankkaukset"),r.a.createElement(ie.a.Item,{as:o.c,to:"/my-details",position:"right",className:"menu-item-spacing",active:"/my-details"===a,onClick:function(){i(F("/my-details")),i(O())}},r.a.createElement(te.a,{name:"user circle outline"}),t),r.a.createElement(ie.a.Item,null,r.a.createElement(X.a,{onClick:function(){i(P())},compact:!0,icon:"log out",content:"Poistu"}))))}),ce=a(46),oe=a(84),ue=(a(441),function(e){var t=Object(c.c)((function(e){return e.note})),a=Object(c.b)(),n=function(){var e=Object(v.a)(f.a.mark((function e(t,n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={user:{name:t.name,username:t.username,password:t.password}},e.prev=1,e.next=4,x.addUser(r);case 4:n({fields:""}),a(y({type:"info",header:"Rekister\xf6inti onnistui",content:"Voit nyt kirjautua sis\xe4\xe4n kirjautumissivun kautta",timeout:3.5})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a(y({type:"error",header:"Rekister\xf6inti ep\xe4onnistui",content:"Ole hyv\xe4 ja yrit\xe4 my\xf6hemmin uudelleen",timeout:3.5}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(ce.d,{initialValues:{name:"",username:"",password:"",confirmPassword:""},validationSchema:oe.a().shape({name:oe.c().required("Nimi on pakollinen tieto").matches(/^\w[a-zA-Z\xe4\xf6\xe5\xc4\xd6\xc5(\- )]+[\w\xe4\xf6\xe5\xc4\xd6\xc5]+$/,"Nimi saa sis\xe4lt\xe4\xe4 vain kirjaimia.").min(5,"Nimi oltava v\xe4hint\xe4\xe4n 5 merkki\xe4 pitk\xe4").max(50,"Nimen maksimipituus on 50 merkki\xe4"),username:oe.c().required("K\xe4ytt\xe4j\xe4tunnus on pakollinen tieto").matches(/^[\w]*[a-zA-Z\xe4\xf6\xe5\xc4\xd6\xc5]+[\w]$/,"K\xe4ytt\xe4j\xe4tunnus saa sis\xe4lt\xe4\xe4 vain kirjaimia ja numeroita.").min(5,"K\xe4ytt\xe4j\xe4tunnus v\xe4hint\xe4\xe4n 5 merkki\xe4 pitk\xe4").max(12,"K\xe4ytt\xe4j\xe4tunnuksen maksimipituus on 12 merkki\xe4"),password:oe.c().required("Salasana on pakollinen tieto").matches(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]/,"Salasanassa oltava v\xe4hint\xe4\xe4n yksi kirjain, yksi numero ja yksi erikoismerkki.").min(6,"Salasanan oltava v\xe4hint\xe4\xe4n 6 merkki\xe4 pitk\xe4").max(32,"Salasanan maksimipituus on 32 merkki\xe4"),confirmPassword:oe.c().required("Salasanan varmistus on pakollinen tieto").oneOf([oe.b("password"),null],"Salasana ja sen varmistus eiv\xe4t vastaa toisiaan.")}),onSubmit:function(e,t){var a=t.resetForm;n(e,a)}},(function(e){var n=e.errors,i=(e.status,e.touched);return r.a.createElement("div",null,r.a.createElement(W.a,{textAlign:"center",style:{height:"75vh"},verticalAlign:"middle"},r.a.createElement(W.a.Column,{style:{maxWidth:350}},r.a.createElement(J.a,{as:"h2",color:"orange",textAlign:"center"},"Rekister\xf6i k\xe4ytt\xe4j\xe4tunnus"),r.a.createElement(Q.a,{raised:!0},r.a.createElement(ce.c,{id:"registrationForm",className:"form-container"},r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"name"},"Nimi:"),r.a.createElement(ce.b,{name:"name",type:"text",placeholder:"Etunimi Sukunimi",className:"form-control"+(n.name&&i.name?" is-invalid":"")}),r.a.createElement(ce.a,{name:"name",component:"div",className:"invalid-feedback"}))),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"K\xe4ytt\xe4j\xe4tunnus:"),r.a.createElement(ce.b,{name:"username",type:"text",placeholder:"K\xe4ytt\xe4j\xe4tunnus",className:"form-control"+(n.username&&i.username?" is-invalid":"")}),r.a.createElement(ce.a,{name:"username",component:"div",className:"invalid-feedback"}))),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Salasana:"),r.a.createElement(ce.b,{name:"password",type:"password",placeholder:"Salasana",className:"form-control"+(n.password&&i.password?" is-invalid":"")}),r.a.createElement(ce.a,{name:"password",component:"div",className:"invalid-feedback"}))),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"confirmPassword"},"Toista salasana:"),r.a.createElement(ce.b,{name:"confirmPassword",type:"password",placeholder:"Toista salasana",className:"form-control"+(n.confirmPassword&&i.confirmPassword?" is-invalid":"")}),r.a.createElement(ce.a,{name:"confirmPassword",component:"div",className:"invalid-feedback"}))),r.a.createElement("div",{className:"reg-form-footer-row"},r.a.createElement(X.a,{secondary:!0,type:"reset",icon:"erase",content:"Tyhjenn\xe4"}),r.a.createElement(X.a,{primary:!0,type:"submit",icon:"checkmark",content:"L\xe4het\xe4"})))),r.a.createElement("div",{className:"reg-form-link-back-row"},r.a.createElement(o.b,{to:"/login",onClick:function(){return a(O())}},r.a.createElement(te.a,{name:"arrow alternate circle left outline"}),"Palaa kirjautumiseen")),t?r.a.createElement(ae,null):null)))}))}),se=a(515),me=function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}},de=function(){var e=Object(n.useState)(me()),t=Object($.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e=function(){r(me())};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),a},fe=a(517),ve=a(514),pe=a(155),Ee=a.n(pe),he=(a(248),a(115)),be=function(e){var t=e.vehicle,a=(e.user,Object(n.useState)(!1)),i=Object($.a)(a,2),l=i[0],o=i[1],u=Object(n.useState)(""),s=Object($.a)(u,2),m=s[0],d=s[1],p=Object(n.useState)(""),E=Object($.a)(p,2),h=E[0],b=E[1],k=Object(n.useState)(""),g=Object($.a)(k,2),j=g[0],w=g[1],N=Object(n.useState)(""),x=Object($.a)(N,2),C=x[0],T=x[1],A=Object(n.useState)(""),I=Object($.a)(A,2),_=I[0],R=I[1],D=Object(n.useState)(!0),M=Object($.a)(D,2),U=M[0],P=M[1],V=Object(n.useState)({state:!1,text:""}),L=Object($.a)(V,2),F=L[0],K=L[1],z=Object(n.useState)({state:!1,text:""}),G=Object($.a)(z,2),H=G[0],B=G[1],Y=Object(n.useState)({state:!1,text:""}),J=Object($.a)(Y,2),Z=J[0],q=J[1],ae=Object(n.useState)(void 0),ne=Object($.a)(ae,2),re=ne[0],ie=ne[1],le=Object(c.b)();Object(n.useEffect)((function(){t&&(t.refuelings.length>0?(t.refuelings.sort((function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()})),ie(t.refuelings[0])):ie({odoMeter:t.odoMeter})),m||d(new Date)}),[t,m]);var ce=function(){d(""),b(""),w(""),T(""),R(""),K({state:!1,text:""}),B({state:!1,text:""}),q({state:!1,text:""}),P(!0)},oe=function(e){ce(),o(!1)},ue=function(){var e={refueling:{type:U?"addEnd":"addMiddle",vehicle:t.id,date:m,odoMeter:h,liters:j,trip:C,avgConsumption:_}};le(function(e){return function(){var t=Object(v.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.addRefueling(e);case 3:n=t.sent,a({type:"ADD_REFUELING",data:n}),a(y({type:"info",header:void 0,content:"Uusi tankkaus lis\xe4ytty onnistuneesti.",timeout:3.5})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),a(y({type:"error",header:void 0,content:"Odottamaton virhe tankkauksen lis\xe4yksess\xe4. Yrit\xe4 my\xf6hemmin uudelleen.",timeout:3.5}));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(e)),ce(),o(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(fe.a,{closeIcon:!0,onClose:function(){return oe()},onOpen:function(){return o(!0)},open:l,closeOnDimmerClick:!1,closeOnEscape:!1,size:"tiny",trigger:r.a.createElement("div",{className:"add-new-link",onClick:function(){return le(O())}},r.a.createElement(te.a,{name:"add"}),"Lis\xe4\xe4 tankkaus")},r.a.createElement(fe.a.Header,null,"Lis\xe4\xe4 uusi tankkaus"),r.a.createElement(fe.a.Content,null,r.a.createElement(W.a,{textAlign:"center",verticalAlign:"top"},r.a.createElement(W.a.Column,{style:{maxWidth:400}},r.a.createElement(Q.a,{raised:!0},r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"Ajoneuvo:"),r.a.createElement(ve.a,{className:"refueling-input",name:"vehicle",type:"text",value:"".concat(t.name," (").concat(t.licensePlateId,")"),fluid:!0,disabled:!0})),r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"P\xe4iv\xe4m\xe4\xe4r\xe4:"),r.a.createElement(Ee.a,{className:"refueling-input dp-custom editable",value:m,selected:m,dateFormat:"d.M.yyyy",onChange:function(e){return function(e){b(""),w(""),T(""),R(""),re&&new Date(e).getTime()<new Date(re.date)?P(!1):P(!0),d(e)}(e)},onChangeRaw:function(e){return e.preventDefault()},maxDate:Object(he.default)(new Date,0)})),U?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"Matkamittari:"),r.a.createElement(ve.a,{className:"refueling-input".concat(F.state?" error":" editable"),name:"odoMeter",type:"text",placeholder:"Anna kilometrit (aiempi: ".concat(t.odoMeter,")"),value:h,fluid:!0,onChange:function(e){return b(e.target.value)},onBlur:function(){return function(){if(K({state:!1,text:""}),h)if(Number.isInteger(Number(h)))if(re&&h<=re.odoMeter)K({state:!0,text:"Arvon tulee olla suurempi kuin aiempi matkamittarin lukema (".concat(re.odoMeter,").")});else{var e=h-re.odoMeter;T(e),j&&!H.state&&R((j/e*100).toFixed(2))}else K({state:!0,text:"Arvon tulee olla kokonaisluku."});else K({state:!0,text:"Kentt\xe4 ei saa olla tyhj\xe4."})}()}}),F.state?r.a.createElement(ee.a,{error:!0,content:F.text}):null)):null,r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"Litrat:"),r.a.createElement(ve.a,{className:"refueling-input".concat(H.state?" error":" editable"),name:"liters",type:"text",placeholder:"Anna litrat",value:j,fluid:!0,onChange:function(e){return w(e.target.value)},onBlur:function(){B(!1),j?isNaN(j)?B({state:!0,text:"Arvon tulee olla numeerinen."}):j<=0?B({state:!0,text:"Arvon tulee olla nollaa suurempi."}):C&&!Z.state&&R((j/C*100).toFixed(2)):B({state:!0,text:"Kentt\xe4 ei saa olla tyhj\xe4."})}}),H.state?r.a.createElement(ee.a,{error:!0,content:H.text}):null),r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"Trippi:"),r.a.createElement(ve.a,{className:"refueling-input".concat(U?"":" editable").concat(Z.state?" error":""),name:"trip",type:"text",placeholder:U?"ei viel\xe4 laskettavissa":"Anna kilometrit",value:C,fluid:!0,onChange:function(e){return T(e.target.value)},onBlur:function(){q(!1),C?isNaN(C)?q({state:!0,text:"Arvon tulee olla numeerinen."}):C<=0?q({state:!0,text:"Arvon tulee olla nollaa suurempi."}):j&&!F.state&&R((j/C*100).toFixed(2)):q({state:!0,text:"Kentt\xe4 ei saa olla tyhj\xe4."})},disabled:U}),Z.state?r.a.createElement(ee.a,{error:!0,content:Z.text}):null),r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"KA. kulutus:"),r.a.createElement(ve.a,{className:"refueling-input",name:"avgConsumption",type:"text",placeholder:"ei viel\xe4 laskettavissa",value:_,fluid:!0,onChange:function(e){return R(e.target.value)},disabled:!0})))))),r.a.createElement(fe.a.Actions,{className:"refueling-modal-actions"},r.a.createElement(X.a,{color:"black",content:"Peruuta",icon:"cancel",onClick:function(){return oe()}}),r.a.createElement(X.a,{color:"blue",content:"Tyhjenn\xe4",icon:"erase",onClick:function(e){ce()}}),r.a.createElement(X.a,{content:"Tallenna",icon:"checkmark",onClick:function(e){return ue()},positive:!0,disabled:!(U&&h&&!F.state&&j&&!H.state||!U&&j&&!H.state&&C&&!Z.state)}))))},ke=function(e){var t=e.vehicle,a=e.primary,i=e.listStates,l=e.user,o=Object(n.useState)(!1),u=Object($.a)(o,2),s=u[0],m=u[1],d=de().width,f=Object(c.b)();Object(n.useEffect)((function(){if(i&&i.length>0){var e=i.find((function(e){return e.id===t.id}));e&&"open"===e.state&&m(!0)}}),[i,t.id]);var v=function(e){return new Date(e).toLocaleDateString("fi-FI",{year:"numeric",month:"numeric",day:"numeric"})},p=function(e){return e%1===0?e.toFixed(1):e.toFixed(2)},E=function(){var e;m(!s),f((e=t.id,function(t){t({type:"TOGGLE_LIST_STATE",data:e})}))},h=function(){return 0===t.refuelings.length?null:Number(d)<550?r.a.createElement(W.a.Row,{className:"refueling-title-row",columns:3},r.a.createElement(W.a.Column,null,"Pvm"),r.a.createElement(W.a.Column,null,"Trippi"),r.a.createElement(W.a.Column,null,"KA. kulutus")):r.a.createElement(W.a.Row,{className:"refueling-title-row",columns:6},r.a.createElement(W.a.Column,null,"Tankkaaja"),r.a.createElement(W.a.Column,null,"Pvm"),r.a.createElement(W.a.Column,null,"Matkamittari"),r.a.createElement(W.a.Column,null,"Litrat"),r.a.createElement(W.a.Column,null,"Trippi"),r.a.createElement(W.a.Column,null,"KA. kulutus"))},b=function(){return 0===t.refuelings.length?r.a.createElement(W.a.Row,null,r.a.createElement(W.a.Column,{colSpan:6},"Ei kirjattuja tankkauksia")):t.refuelings.map((function(e,t){return Number(d)<550?r.a.createElement(W.a.Row,{className:t%2===0?"refueling-entry-row":"refueling-entry-row hl-row",columns:3,key:e.id,onClick:function(){return f(z(e))}},r.a.createElement(W.a.Column,null,v(e.date)),r.a.createElement(W.a.Column,null,e.tripKilometers),r.a.createElement(W.a.Column,null,p(e.avgConsumption))):r.a.createElement(W.a.Row,{className:t%2===0?"refueling-entry-row":"refueling-entry-row hl-row",columns:6,key:e.id,onClick:function(){return f(z(e))}},r.a.createElement(W.a.Column,null,e.user.name),r.a.createElement(W.a.Column,null,v(e.date)),r.a.createElement(W.a.Column,null,e.odoMeter),r.a.createElement(W.a.Column,null,p(e.liters)),r.a.createElement(W.a.Column,null,e.tripKilometers),r.a.createElement(W.a.Column,null,p(e.avgConsumption)))}))};return t.refuelings.sort((function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()})),r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,null,r.a.createElement(W.a.Row,{className:"vehicle-title-row",columns:6},r.a.createElement(W.a.Column,{className:"cursor-pointer",textAlign:"left",width:8,onClick:E},a===t.id?r.a.createElement(te.a,{className:"primary-vehicle-icon",name:"star"}):null,t.name),r.a.createElement(W.a.Column,{textAlign:"right",width:8,className:"vehicle-title-row-right-column"},r.a.createElement(be,{vehicle:t,user:l}),r.a.createElement(te.a,{name:s?"angle up":"angle down",onClick:E,className:"cursor-pointer"}))),s?r.a.createElement(r.a.Fragment,null,r.a.createElement(h,null),r.a.createElement(b,null)):null,r.a.createElement(se.a,null)))},ge=(a(498),function(){var e=Object(c.c)((function(e){return e.refueling})),t=Object(c.c)((function(e){return e.user})),a=Object(n.useState)(!1),i=Object($.a)(a,2),l=i[0],o=i[1],u=Object(n.useState)(void 0),s=Object($.a)(u,2),m=s[0],d=s[1],p=Object(n.useState)(void 0),E=Object($.a)(p,2),h=E[0],b=E[1],k=Object(n.useState)(),g=Object($.a)(k,2),j=g[0],w=g[1],N=Object(n.useState)(""),x=Object($.a)(N,2),C=x[0],T=x[1],A=Object(n.useState)(!1),I=Object($.a)(A,2),_=I[0],R=I[1],D=Object(n.useState)(),M=Object($.a)(D,2),U=M[0],P=M[1],V=Object(n.useState)(""),L=Object($.a)(V,2),F=L[0],K=L[1],z=Object(n.useState)(!1),G=Object($.a)(z,2),H=G[0],B=G[1],Y=Object(n.useState)(""),J=Object($.a)(Y,2),Z=J[0],q=J[1],te=Object(n.useState)(!1),ae=Object($.a)(te,2),ne=ae[0],re=ae[1],ie=Object(n.useState)(),le=Object($.a)(ie,2),ce=le[0],oe=le[1],ue=Object(n.useState)(""),se=Object($.a)(ue,2),me=se[0],de=se[1],pe=Object(n.useState)(!1),be=Object($.a)(pe,2),ke=be[0],ge=be[1],je=Object(n.useState)(""),ye=Object($.a)(je,2),Oe=ye[0],we=ye[1],Ne=Object(n.useState)(""),xe=Object($.a)(Ne,2),Ce=xe[0],Se=xe[1],Te=Object(n.useState)(""),Ae=Object($.a)(Te,2),Ie=Ae[0],_e=Ae[1],Re=Object(c.b)();Object(n.useEffect)((function(){if(0!==Object.keys(e).length){Re(O()),b(new Date(e.date)),d(new Date(e.date)),T(e.odoMeter),w(e.odoMeter),K(e.liters),P(e.liters),q(e.tripKilometers),oe(e.tripKilometers),de(e.avgConsumption),o(!0);var a=t.vehicles.find((function(t){return t.id===e.vehicle.id}));a.refuelings.sort((function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()})),e.id===a.refuelings[0].id&&e.odoMeter===a.odoMeter?(Se(!0),_e(!0)):(Se(!1),_e(!1))}}),[Re,e,t.vehicles]);var De=function(e){var t;Re((t=e,function(){var e=Object(v.a)(f.a.mark((function e(a){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.removeRefueling(t);case 3:n=e.sent,a({type:"REMOVE_REFUELING_FROM_USER",data:n}),a(y({type:"info",header:void 0,content:"Tankkausmerkint\xe4 poistettu onnistuneesti.",timeout:3.5})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a(y({type:"error",header:void 0,content:"Odottamaton virhe tankkausmerkinn\xe4n poistossa. Yrit\xe4 my\xf6hemmin uudelleen.",timeout:3.5}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),Re((function(e){e({type:"RESET_REFUELING_ENTRY",data:{}})})),ge(!1),o(!1)},Me=function(e){return e.showError?r.a.createElement(ee.a,{error:!0},r.a.createElement("p",null,Oe)):null};if(0===Object.keys(e).length)return null;var Ue=function(){return e.vehicle.owner===t.id||e.user.id===t.id};return r.a.createElement(r.a.Fragment,null,r.a.createElement(fe.a,{closeIcon:!0,onClose:function(e){return function(e){e.stopPropagation(),e.target===e.currentTarget&&(o(!1),Re((function(e){e({type:"RESET_REFUELING_ENTRY",data:{}})})),R(!1),B(!1),re(!1),Se(!0))}(e)},onOpen:function(){return o(!0)},open:l,closeOnDimmerClick:!1,closeOnEscape:!1,size:"tiny"},r.a.createElement(fe.a.Header,null,"Muokkaa tankkausta"),r.a.createElement(fe.a.Content,null,r.a.createElement(W.a,{textAlign:"center",verticalAlign:"top"},r.a.createElement(W.a.Column,{style:{maxWidth:400}},r.a.createElement(Q.a,{raised:!0},r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"Ajoneuvo:"),r.a.createElement(ve.a,{className:"refueling-input",name:"vehicle",type:"text",value:"".concat(e.vehicle.name," (").concat(e.vehicle.licensePlateId,")"),disabled:!0,fluid:!0})),r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"Tankkaaja:"),r.a.createElement(ve.a,{className:"refueling-input",name:"user",type:"text",value:e.user.name,disabled:!0,fluid:!0})),r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"P\xe4iv\xe4m\xe4\xe4r\xe4:"),r.a.createElement(Ee.a,{className:Ue()?"refueling-input dp-custom editable":"refueling-input dp-custom dp-disabled",value:h,selected:h,dateFormat:"d.M.yyyy",onChange:function(a){return function(a){var n=new Date(a).toISOString().split("T")[0],r=new Date(m).toISOString().split("T")[0];1===t.vehicles.find((function(t){return t.id===e.vehicle.id})).refuelings.length?Se(!0):n===r&&Ie?(Se(!0),b(new Date(m))):Se(!1),b(new Date(a))}(a)},onChangeRaw:function(e){return e.preventDefault()},disabled:!Ue(),maxDate:Object(he.default)(new Date,0)})),r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"Matkamittari:"),r.a.createElement(ve.a,{className:Ue()&&Ce?"refueling-input".concat(_?" error":" editable"):"refueling-input",name:"odoMeter",type:"text",value:C,fluid:!0,onChange:function(e){return T(e.target.value)},onBlur:function(){if(R(!1),we(""),C)if(Number.isInteger(Number(C)))if(Number(C)<=0)R(!0),we("Virhe! Arvon tulee olla nollaa suurempi.");else if(Number(C)===Number(j))R(!0),we("Virhe! Uusi arvo on sama kuin aiempi.");else{var t=Number(C)-(Number(e.odoMeter)-Number(e.tripKilometers));if(t<=0)q(t),R(!0),we("Virhe! Arvo on liian pieni.");else if(t>2e3)q(t),R(!0),we("Virhe! Arvo on liian suuri.");else{var a=Number(F)/Number(t)*100;q(t),de(a)}}else R(!0),we("Virhe! Arvon tulee olla kokonaisluku.");else R(!0),we("Virhe! Kentt\xe4 ei saa olla tyhj\xe4.")},disabled:!(Ue()&&Ce)}),r.a.createElement(Me,{showError:_})),r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"Litrat:"),r.a.createElement(ve.a,{className:Ue()?"refueling-input".concat(H?" error":" editable"):"refueling-input",name:"liters",type:"text",value:F,fluid:!0,onChange:function(e){return K(e.target.value)},onBlur:function(){if(B(!1),we(""),F)if(isNaN(F))B(!0),we("Virhe! Arvon tulee olla numero.");else if(Number(F)<=0)B(!0),we("Virhe! Arvon tulee olla nollaa suurempi.");else if(Number(F)===Number(U))B(!0),we("Virhe! Uusi arvo on sama kuin aiempi.");else{var e=Number(F)/Number(Z)*100;de(e)}else B(!0),we("Virhe! Kentt\xe4 ei saa olla tyhj\xe4.")},disabled:!Ue()}),r.a.createElement(Me,{showError:H})),r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"Trippi:"),r.a.createElement(ve.a,{className:!Ue()||Ce?"refueling-input":"refueling-input".concat(ne?" error":" editable"),name:"trip",type:"text",value:Z,fluid:!0,onChange:function(e){return q(e.target.value)},onBlur:function(){if(re(!1),we(""),Z)if(isNaN(Z))re(!0),we("Virhe! Arvon tulee olla numero.");else if(Number(Z)<=0)re(!0),we("Virhe! Arvon tulee olla nollaa suurempi.");else if(Number(Z)===Number(ce))re(!0),we("Virhe! Uusi arvo on sama kuin aiempi.");else{var e=Number(F)/Number(Z)*100;de(e)}else re(!0),we("Virhe! Kentt\xe4 ei saa olla tyhj\xe4.")},disabled:!(Ue()&&!Ce)}),r.a.createElement(Me,{showError:ne})),r.a.createElement("div",{className:"refueling-input-block"},r.a.createElement("div",{className:"row-label"},"KA. kulutus:"),r.a.createElement(ve.a,{className:"refueling-input",name:"avgConsumption",type:"text",value:Number(me).toFixed(2),disabled:!0,fluid:!0}))),Ue()?null:r.a.createElement(ee.a,{warning:!0,header:"Muokkaus lukittu!",content:"Vain ajoneuvon omistaja tai tankkaaja itse voi muokata merkint\xe4\xe4."})))),r.a.createElement(fe.a.Actions,{className:"refueling-modal-actions"},r.a.createElement(X.a,{color:"blue",content:"Palauta",icon:"erase",onClick:function(){Re(O()),b(new Date(e.date)),d(new Date(e.date)),T(e.odoMeter),w(e.odoMeter),K(e.liters),P(e.liters),q(e.tripKilometers),oe(e.tripKilometers),de(e.avgConsumption),o(!0),we(""),B(!1),R(!1),re(!1);var a=t.vehicles.find((function(t){return t.id===e.vehicle.id}));a.refuelings.sort((function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()})),e.id===a.refuelings[0].id&&e.odoMeter===a.odoMeter?(Se(!0),_e(!0)):(Se(!1),_e(!1))},disabled:!(!Ce||new Date(h).getTime()!==new Date(m).getTime()||C!==j||F!==U)||!Ce&&new Date(h).getTime()===new Date(m).getTime()&&F===U&&Z===ce}),r.a.createElement(X.a,{color:"red",content:"Poista",icon:"delete",onClick:function(){return ge(!0)},disabled:!Ue()}),r.a.createElement(X.a,{content:"Tallenna",icon:"checkmark",onClick:function(t){var a;t.stopPropagation(),t.target===t.currentTarget&&(Re((a={refueling:{id:e.id,date:h,odoMeter:C||"0",liters:F,trip:Z||"0"}},function(){var e=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.updateRefueling(a);case 3:n=e.sent,t({type:"UPDATE_USER_REFUELING_ENTRY",data:n}),t(y({type:"info",header:void 0,content:"Tankkausmerkint\xe4 p\xe4ivitetty onnistuneesti.",timeout:3.5})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t(y({type:"error",header:void 0,content:"Odottamaton virhe tankkausmerkinn\xe4n p\xe4ivityksess\xe4. Yrit\xe4 my\xf6hemmin uudelleen.",timeout:3.5}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),o(!1),Re((function(e){e({type:"RESET_REFUELING_ENTRY",data:{}})})))},positive:!0,disabled:!Ue()||!!(_||H||ne)||!(!h||!m||h.toString()!==m.toString()||C!==j||F!==U||Z!==ce)})),r.a.createElement(fe.a,{closeIcon:!0,onClose:function(){return ge(!1)},onOpen:function(){return ge(!0)},open:ke,closeOnDimmerClick:!1,closeOnEscape:!1,size:"tiny",className:"del-refueling-modal"},r.a.createElement(fe.a.Content,null,r.a.createElement("div",{className:"del-refueling-modal-content"},"Oletko varma, ett\xe4 haluat poistaa t\xe4m\xe4n tankkausmerkinn\xe4n?")),r.a.createElement(fe.a.Actions,null,r.a.createElement(X.a,{color:"black",content:"Peruuta",onClick:function(e){e.stopPropagation(),e.target===e.currentTarget&&ge(!1)}}),r.a.createElement(X.a,{color:"red",content:"Poista",onClick:function(){return De(e.id)}})))))}),je=function(e){var t=e.user,a=Object(c.c)((function(e){return e.listStates})),i=Object(c.c)((function(e){return e.note})),l=Object(c.b)();if(Object(n.useEffect)((function(){if(t.vehicles&&t.vehicles.length>0&&0===a.length){var e=t.vehicles.map((function(e){return t.primaryVehicle===e.id?{id:e.id,state:"open"}:{id:e.id,state:"closed"}}));l(function(e){return function(t){t({type:"INIT_LIST_STATES",data:e})}}(e))}}),[a,t.vehicles,t.primaryVehicle,l]),!t.vehicles||0===t.vehicles.length)return r.a.createElement(W.a,{id:"refueling-list-container",textAlign:"center",verticalAlign:"middle"},r.a.createElement(W.a.Column,{style:{maxWidth:450}},r.a.createElement(J.a,{as:"h2",color:"orange",textAlign:"center"},"Viimeaikaiset tankkaukset"),r.a.createElement(ee.a,{info:!0},r.a.createElement(te.a,{name:"exclamation"}),"Ei lis\xe4ttyj\xe4 ajoneuvoja.",r.a.createElement(o.c,{to:"/my-details",className:"add-new-link",onClick:function(){return l(F("/my-details"))}}," Lis\xe4\xe4 uusi?"))));var u=function(){var e=t.vehicles.filter((function(e){return e.owner.id===t.id}));return 0===e.length?null:(e.sort((function(e,t){return e.name.localeCompare(t.name)})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"sub-header"},"Omistamani ajoneuvot"),r.a.createElement(Q.a,{raised:!0},e.map((function(e){return r.a.createElement(ke,{key:e.id,vehicle:e,primary:t.primaryVehicle,listStates:a,user:t})})))))},s=function(){var e=t.vehicles.filter((function(e){return e.owner.id!==t.id}));return 0===e.length?null:(e.sort((function(e,t){return e.name.localeCompare(t.name)})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"sub-header"},"K\xe4ytt\xe4m\xe4ni ajoneuvot"),r.a.createElement(Q.a,{raised:!0},e.map((function(e){return r.a.createElement(ke,{key:e.id,vehicle:e,primary:t.primaryVehicle,listStates:a,user:t})})))))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{id:"refueling-list-container",textAlign:"center",verticalAlign:"middle"},r.a.createElement(W.a.Column,null,r.a.createElement(J.a,{as:"h2",color:"orange",textAlign:"center"},"Viimeaikaiset tankkaukset"),r.a.createElement(u,null),r.a.createElement(s,null),i?r.a.createElement(ae,null):null)),r.a.createElement(ge,null))},ye=a(513),Oe=function(e){var t=e.label,a=e.name,n=e.value,i=e.disabled,l=e.onChange,c=e.blockStyle,o=e.onBlur,u=e.inputError;return r.a.createElement("div",{className:c},r.a.createElement("div",{className:"row-label"},t),r.a.createElement(ve.a,{className:"add-vehicle-input".concat(u?" error":""),name:a,type:"text",value:n,disabled:i,onChange:l,onBlur:o}))},we=function(e){var t=e.coOwners,a=e.onClickHandler,n=e.delDisabled;if(!t||0===t.length)return r.a.createElement("div",null,"Ajoneuvolla ei muita k\xe4ytt\xe4ji\xe4");var i=t.map((function(e){return r.a.createElement("div",{key:e.id,className:"co-owner-tag-item".concat(n?" del-disabled":"")},r.a.createElement("div",null,e.name),n?null:r.a.createElement("div",null,r.a.createElement(te.a,{name:"delete",color:"grey",onClick:function(){return a(e)}})))}));return r.a.createElement("div",{className:"co-owner-tag-container"},i)},Ne=function(e){var t=e.delDisabled,a=e.coOwner,n=e.coOwners,i=e.handleDelCoOwnerOnClick,l=e.handleCoOwnerONChange,c=e.handleAddCoOwnerOnClick;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"row-label"},"Ajoneuvon muut k\xe4ytt\xe4j\xe4t:"),r.a.createElement(we,{delDisabled:t,coOwners:n,onClickHandler:i})),t?null:r.a.createElement("div",{className:"co-owner-container"},r.a.createElement(ve.a,{className:"co-owner-item",name:"coOwner",type:"text",value:a,placeholder:"K\xe4ytt\xe4j\xe4tunnus",onChange:l}),r.a.createElement(X.a,{content:"Lis\xe4\xe4",disabled:!a,onClick:c})))},xe=function(e){var t=e.user,a=e.users,i=Object(n.useState)(!1),l=Object($.a)(i,2),o=l[0],u=l[1],s=Object(n.useState)(""),m=Object($.a)(s,2),d=m[0],p=m[1],E=Object(n.useState)({state:!1,text:""}),h=Object($.a)(E,2),b=h[0],k=h[1],g=Object(n.useState)(""),j=Object($.a)(g,2),w=j[0],N=j[1],x=Object(n.useState)({state:!1,text:""}),S=Object($.a)(x,2),A=S[0],I=S[1],R=Object(n.useState)(""),D=Object($.a)(R,2),M=D[0],U=D[1],P=Object(n.useState)({state:!1,text:""}),V=Object($.a)(P,2),L=V[0],F=V[1],K=Object(n.useState)(""),z=Object($.a)(K,2),G=z[0],H=z[1],B=Object(n.useState)([]),Y=Object($.a)(B,2),J=Y[0],Z=Y[1],q=Object(n.useState)(!1),te=Object($.a)(q,2),ne=te[0],re=te[1],ie=Object(c.c)((function(e){return e.note})),le=Object(c.b)(),ce=function(){le(O()),p(""),N(""),U(""),H(""),Z([]),re(!1),k({state:!1,text:""}),I({state:!1,text:""}),F({state:!1,text:""})},oe=function(){var e;d&&w&&M?(le((e={vehicle:{name:d,licensePlateId:w,odoMeter:M,coOwners:J.map((function(e){return e.id}))},primaryVehicle:ne},function(){var t=Object(v.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.addVehicle(e);case 3:n=t.sent,a({type:"ADD_VEHICLE_TO_USER",data:n}),a(_({id:n.vehicle.id,state:n.primary?"open":"closed"})),a(y({type:"info",header:void 0,content:"Ajoneuvo ".concat(n.vehicle.name," (").concat(n.vehicle.licensePlateId,") lis\xe4tty onnistuneesti."),timeout:3.5})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a(y({type:"error",header:void 0,content:"Odottamaton virhe ajoneuvon lis\xe4yksess\xe4. Yrit\xe4 my\xf6hemmin uudelleen.",timeout:3.5}));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}())),p(""),N(""),U(""),H(""),Z([]),re(!1),u(!1)):le(y({type:"error",header:void 0,content:"Virheellinen sy\xf6te",timeout:3.5}))};return r.a.createElement(fe.a,{closeIcon:!0,onClose:function(){u(!1),le(O())},onOpen:function(){return u(!0)},open:o,size:"tiny",closeOnDimmerClick:!1,closeOnEscape:!1,trigger:r.a.createElement(X.a,{color:"blue",content:"Lis\xe4\xe4 ajoneuvo",onClick:function(){return le(O())}})},r.a.createElement(fe.a.Header,null,"Lis\xe4\xe4 ajoneuvo"),r.a.createElement(fe.a.Content,null,r.a.createElement(W.a,{textAlign:"center",verticalAlign:"top"},r.a.createElement(W.a.Column,{style:{maxWidth:400}},r.a.createElement(Q.a,{raised:!0},r.a.createElement("div",{className:"vehicle-name-container"},r.a.createElement(Oe,{label:"Ajoneuvon nimi:",name:"name",value:d,disabled:!1,onChange:function(e){return p(e.target.value)},onBlur:function(){k({state:!1,text:""}),d?/^[\w]*(([a-zA-Z\xe4\xf6\xe5\xc4\xd6\xc5]+)|( )|(-))[\w]*$/.test(d)?d.length<4?k({state:!0,text:"Nimen oltava v\xe4hint\xe4\xe4n 4 merkki\xe4 pitk\xe4."}):d.length>20&&k({state:!0,text:"Nimen enimm\xe4ispituus on 20 merkki\xe4."}):k({state:!0,text:"Nimi saa sis\xe4lt\xe4\xe4 vain kirjaimia ja numeroita sek\xe4 yhden v\xe4lily\xf6nnin tai -viivan."}):k({state:!0,text:"Kentt\xe4 ei saa olla tyhj\xe4."})},blockStyle:"vehicle-name",inputError:b.state}),r.a.createElement(ye.a,{label:"Ensisijainen",className:"primary-checkbox",onChange:function(){re(!ne)}})),b.state?r.a.createElement(ee.a,{error:!0,content:b.text}):null,r.a.createElement(Oe,{label:"Rekisterinumero:",name:"licensePlateId",value:w,disabled:!1,onChange:function(e){return N(e.target.value)},onBlur:function(){I({state:!1,text:""}),w?/(^[\D]{2,3}(-)[\d]{1,3}$)|(^[C][D](-)[\d]{1,4}$)/.test(w)||I({state:!0,text:"Rekisteritunnus tulee olla muodossa 2-3 kirjainta, v\xe4liviiva ja 1-3 numeroa (CD-alkuisena sallitaan 4 numeroa)."}):I({state:!0,text:"Kentt\xe4 ei saa olla tyhj\xe4."})},inputError:A.state}),A.state?r.a.createElement(ee.a,{error:!0,content:A.text}):null,r.a.createElement(Oe,{label:"Matkamittarin lukema:",name:"odoMeter",value:M,disabled:!1,onChange:function(e){return U(e.target.value)},onBlur:function(){F({state:!1,text:""}),M?isNaN(M)?F({state:!0,text:"Matkamittarin lukema tulee olla numeerinen."}):Number(M)<0?F({state:!0,text:"Matkamittarin lukema ei saa olla negatiivinen."}):Number(M)>5e6&&F({state:!0,text:"Matkamittarin lukema ei saa olla yli 5 000 000 km."}):F({state:!0,text:"Kentt\xe4 ei saa olla tyhj\xe4."})},inputError:L.state}),L.state?r.a.createElement(ee.a,{error:!0,content:L.text}):null,r.a.createElement(Ne,{coOwner:G,coOwners:J,handleDelCoOwnerOnClick:function(e){var t=Object(T.a)(J);t=t.filter((function(t){return t.id!==e.id})),Z(t)},handleCoOwnerONChange:function(e){return H(e.target.value)},handleAddCoOwnerOnClick:function(e){if(G!==t.username){var n=J.find((function(e){return e.username===G}));if(n)le(y({type:"error",header:void 0,content:"K\xe4ytt\xe4j\xe4 '".concat(n.name,"' on jo lis\xe4tty ajoneuvon toiseksi k\xe4ytt\xe4j\xe4ksi."),timeout:3.5}));else{var r=a.find((function(e){return e.username===G}));if(r){var i=Object(T.a)(J);i.push(r),Z(i),H("")}else le(y({type:"error",header:void 0,content:"K\xe4ytt\xe4j\xe4\xe4 '".concat(G,"' ei l\xf6ydy. Tarkista antamasi tunnus."),timeout:3.5}))}}else le(y({type:"error",header:void 0,content:"Ajoneuvon omistajana et voi asettaa itse\xe4si toiseksi k\xe4ytt\xe4j\xe4ksi.",timeout:3.5}))}}),ie?r.a.createElement(ae,null):null)))),r.a.createElement(fe.a.Actions,{className:"vehicle-modal-actions"},r.a.createElement(X.a,{color:"black",content:"Peruuta",icon:"cancel",onClick:function(){return ce(),void u(!1)}}),r.a.createElement(X.a,{color:"blue",content:"Tyhjenn\xe4",icon:"erase",onClick:function(e){ce()}}),r.a.createElement(X.a,{content:"Tallenna",icon:"checkmark",onClick:function(){return oe()},positive:!0,disabled:!(d&&!b.state&&w&&!A.state&&M&&!L.state)})))},Ce=function(e){var t=e.vehicle,a=e.user,i=e.users,l=Object(n.useState)(!1),o=Object($.a)(l,2),u=o[0],s=o[1],m=Object(n.useState)(!1),d=Object($.a)(m,2),p=d[0],E=d[1],h=Object(n.useState)(""),b=Object($.a)(h,2),k=b[0],g=b[1],j=Object(n.useState)({state:!1,text:""}),w=Object($.a)(j,2),N=w[0],x=w[1],S=Object(n.useState)(""),A=Object($.a)(S,2),_=A[0],R=A[1],M=Object(n.useState)({state:!1,text:""}),U=Object($.a)(M,2),P=U[0],V=U[1],L=Object(n.useState)(""),F=Object($.a)(L,2),K=F[0],z=F[1],G=Object(n.useState)({state:!1,text:""}),H=Object($.a)(G,2),B=H[0],Y=H[1],J=Object(n.useState)(!1),Z=Object($.a)(J,2),q=Z[0],ne=Z[1],re=Object(n.useState)(""),ie=Object($.a)(re,2),le=ie[0],ce=ie[1],oe=Object(n.useState)([]),ue=Object($.a)(oe,2),se=ue[0],me=ue[1],de=Object(n.useState)(!1),ve=Object($.a)(de,2),pe=ve[0],Ee=ve[1],he=Object(n.useState)(!1),be=Object($.a)(he,2),ke=be[0],ge=be[1],je=Object(c.c)((function(e){return e.note})),we=Object(c.b)();Object(n.useEffect)((function(){u&&(a.primaryVehicle===t.id?(Ee(!0),ge(!0)):(Ee(!1),ge(!1)),g(t.name),R(t.licensePlateId),z(t.odoMeter),me(t.coOwners),ne(!1))}),[a,u,t]);var xe=function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k&&_&&K?(we(D({vehicle:{id:t.id,name:k,licensePlateId:_,odoMeter:K,coOwners:se.map((function(e){return e.id}))},primaryVehicle:ke?t.id:ke||a.primaryVehicle!==t.id?a.primaryVehicle:""})),g(""),R(""),z(""),ce(""),me([]),ge(!1),Ee(!1),s(!1),ne(!1)):we(y({type:"error",header:void 0,content:"Virheellinen sy\xf6te",timeout:3.5}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(fe.a,{closeIcon:!0,onClose:function(){return we(O()),g(""),R(""),z(""),ce(""),me([]),ge(!1),Ee(!1),ne(!1),x({state:!1,text:""}),V({state:!1,text:""}),Y({state:!1,text:""}),void s(!1)},onOpen:function(){return s(!0)},open:u,closeOnDimmerClick:!1,closeOnEscape:!1,trigger:r.a.createElement("div",{className:"data-row",onClick:function(){return we(O())}},a.primaryVehicle===t.id?r.a.createElement(te.a,{className:"primary-vehicle-icon",name:"star"}):null,t.name," (",t.licensePlateId,")"),size:"tiny"},r.a.createElement(fe.a.Header,null,"Muokkaa ajoneuvoa"),r.a.createElement(fe.a.Content,null,r.a.createElement(W.a,{textAlign:"center",verticalAlign:"top"},r.a.createElement(W.a.Column,{style:{maxWidth:400}},r.a.createElement(Q.a,{raised:!0},r.a.createElement("div",{className:"vehicle-name-container"},r.a.createElement(Oe,{label:"Ajoneuvon nimi:",name:"name",value:k,disabled:a.id!==t.owner.id||q,onChange:function(e){return g(e.target.value)},onBlur:function(){x({state:!1,text:""}),k?k===t.name?x({state:!0,text:"Uusi nimi on sama kuin vanha."}):/^[\w]*(([a-zA-Z\xe4\xf6\xe5\xc4\xd6\xc5]+)|( )|(-))[\w]*$/.test(k)?k.length<4?x({state:!0,text:"Nimen oltava v\xe4hint\xe4\xe4n 4 merkki\xe4 pitk\xe4."}):k.length>20&&x({state:!0,text:"Nimen enimm\xe4ispituus on 20 merkki\xe4."}):x({state:!0,text:"Nimi saa sis\xe4lt\xe4\xe4 vain kirjaimia ja numeroita sek\xe4 yhden v\xe4lily\xf6nnin tai -viivan."}):x({state:!0,text:"Kentt\xe4 ei saa olla tyhj\xe4."})},blockStyle:"vehicle-name",inputError:N.state}),r.a.createElement(ye.a,{label:"Ensisijainen",checked:ke,className:"primary-checkbox",onChange:function(){ge(!ke)}})),N.state?r.a.createElement(ee.a,{error:!0,content:N.text}):null,r.a.createElement(Oe,{label:"Rekisterinumero:",name:"licensePlateId",value:_,disabled:a.id!==t.owner.id||q,onChange:function(e){return R(e.target.value)},onBlur:function(){V({state:!1,text:""}),_?_===t.licensePlateId?V({state:!0,text:"Uusi rekisteritunnus on sama kuin vanha."}):/(^[\D]{2,3}(-)[\d]{1,3}$)|(^[C][D](-)[\d]{1,4}$)/.test(_)||V({state:!0,text:"Rekisteritunnus tulee olla muodossa 2-3 kirjainta, v\xe4liviiva ja 1-3 numeroa (CD-alkuisena sallitaan 4 numeroa)."}):V({state:!0,text:"Kentt\xe4 ei saa olla tyhj\xe4."})},inputError:P.state}),P.state?r.a.createElement(ee.a,{error:!0,content:P.text}):null,r.a.createElement(Oe,{label:"Matkamittarin lukema:",name:"odoMeter",value:K,disabled:a.id!==t.owner.id||q,onChange:function(e){return z(e.target.value)},onBlur:function(){Y({state:!1,text:""}),K?K===t.odoMeter?Y({state:!0,text:"Uusi matkamittarin lukema on sama kuin vanha."}):isNaN(K)?Y({state:!0,text:"Matkamittarin lukema tulee olla numeerinen."}):Number(K)<0?Y({state:!0,text:"Matkamittarin lukema ei saa olla negatiivinen."}):Number(K)>5e6&&Y({state:!0,text:"Matkamittarin lukema ei saa olla yli 5 000 000 km."}):Y({state:!0,text:"Kentt\xe4 ei saa olla tyhj\xe4."})},inputError:B.state}),B.state?r.a.createElement(ee.a,{error:!0,content:B.text}):null,r.a.createElement(Oe,{label:"Ajoneuvon omistaja:",name:"owner",value:t.owner.name,disabled:!0}),r.a.createElement(Ne,{delDisabled:a.id!==t.owner.id,coOwner:le,coOwners:se,handleDelCoOwnerOnClick:function(e){var t=Object(T.a)(se);t=t.filter((function(t){return t.id!==e.id})),me(t)},handleCoOwnerONChange:function(e){return ce(e.target.value)},handleAddCoOwnerOnClick:function(e){if(le!==a.username){var t=se.find((function(e){return e.username===le}));if(t)we(y({type:"error",header:void 0,content:"K\xe4ytt\xe4j\xe4 '".concat(t.name,"' on jo lis\xe4tty ajoneuvon toiseksi k\xe4ytt\xe4j\xe4ksi."),timeout:3.5}));else{var n=i.find((function(e){return e.username===le}));if(n){var r=Object(T.a)(se);r.push(n),me(r),ce("")}else we(y({type:"error",header:void 0,content:"K\xe4ytt\xe4j\xe4\xe4 '".concat(le,"' ei l\xf6ydy. Tarkista antamasi tunnus."),timeout:3.5}))}}else we(y({type:"error",header:void 0,content:"Ajoneuvon omistajana et voi asettaa itse\xe4si toiseksi k\xe4ytt\xe4j\xe4ksi.",timeout:3.5}))}}),je?r.a.createElement(ae,null):null),a.id===t.owner.id?null:r.a.createElement(ee.a,{warning:!0,header:"Muokkaus lukittu!",content:"Ajoneuvon k\xe4ytt\xe4j\xe4n\xe4 voit muokata vain Ensisijainen-tietoa. Muiden tietojen muokkaus edellytt\xe4\xe4 Omistaja-roolia."})))),r.a.createElement(fe.a.Actions,{className:"vehicle-modal-actions"},r.a.createElement(X.a,{color:"blue",content:"Palauta",icon:"erase",onClick:function(){a.primaryVehicle===t.id?(Ee(!0),ge(!0)):(Ee(!1),ge(!1)),g(t.name),R(t.licensePlateId),z(t.odoMeter),me(t.coOwners),ne(!1),x({state:!1,text:""}),V({state:!1,text:""}),Y({state:!1,text:""})},disabled:!(k!==t.name||ke!==pe||_!==t.licensePlateId||K!==t.odoMeter||JSON.stringify(se)!==JSON.stringify(t.coOwners)||N.state||P.state||B.state)}),r.a.createElement(X.a,{color:"red",content:"Poista",icon:"delete",disabled:a.id!==t.owner.id,onClick:function(){return E(!0)}}),r.a.createElement(X.a,{content:"Tallenna",icon:"checkmark",onClick:xe,positive:!0,disabled:!(k&&!N.state&&k!==t.name||_&&!P.state&&_!==t.licensePlateId||K&&!B.state&&K!==t.odoMeter||!(ke===pe||N.state||P.state||B.state)||JSON.stringify(se)!==JSON.stringify(t.coOwners))})),r.a.createElement(fe.a,{closeIcon:!0,onClose:function(){return E(!1)},onOpen:function(){return E(!0)},open:p,closeOnDimmerClick:!1,closeOnEscape:!1,size:"tiny",className:"del-vehicle-modal"},r.a.createElement(fe.a.Content,null,r.a.createElement("div",{className:"del-vehicle-modal-content"},"Oletko varma, ett\xe4 haluat poistaa t\xe4m\xe4n ajoneuvon ja kaikki siihen liittyv\xe4t tankkaukset?")),r.a.createElement(fe.a.Actions,null,r.a.createElement(X.a,{color:"black",content:"Peruuta",onClick:function(e){e.stopPropagation(),e.target===e.currentTarget&&E(!1)}}),r.a.createElement(X.a,{color:"red",content:"Poista",onClick:function(){var e;we((e=t.id,function(){var t=Object(v.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.removeVehicle(e);case 3:n=t.sent,a({type:"REMOVE_VEHICLE_FROM_USER",data:n}),a(I(e)),a(y({type:"info",header:void 0,content:"Ajoneuvo ".concat(n.vehicle.name," (").concat(n.vehicle.licensePlateId,") poistettu onnistuneesti."),timeout:3.5})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),a(y({type:"error",header:void 0,content:"Odottamaton virhe ajoneuvon poistossa. Yrit\xe4 my\xf6hemmin uudelleen.",timeout:3.5}));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}())),g(""),R(""),z(""),E(!1),s(!1)}}))))},Se=function(e){var t=e.user,a=e.users;return 0===Object.keys(t).length?null:0===t.vehicles.length?r.a.createElement("div",{className:"my-details-row"},"Ei ajoneuvoja"):(t.vehicles.sort((function(e,t){return e.name.localeCompare(t.name)})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"my-details-row"},t.vehicles.map((function(e,n){return r.a.createElement(Ce,{key:e.id,vehicle:e,user:t,users:a})})))))},Te=function(e){e.user;var t=Object(n.useState)(!1),a=Object($.a)(t,2),i=a[0],l=a[1],o=Object(n.useState)(""),u=Object($.a)(o,2),s=u[0],m=u[1],d=Object(n.useState)(""),p=Object($.a)(d,2),E=p[0],h=p[1],b=Object(n.useState)(""),k=Object($.a)(b,2),j=k[0],w=k[1],N=Object(c.c)((function(e){return e.note})),C=Object(c.b)(),S=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C(O()),t.preventDefault(),s&&E&&j){e.next=6;break}C(y({type:"error",header:void 0,content:"Virhe! Kaikki kolme kentt\xe4\xe4 on t\xe4ytett\xe4v\xe4.",timeout:3.5})),e.next=29;break;case 6:return e.next=8,g.verifyPwd({user:{password:s}});case 8:if(e.sent){e.next=13;break}C(y({type:"error",header:void 0,content:"Nykyinen salasana on virheellinen.",timeout:3.5})),e.next=29;break;case 13:if(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{6,12}/.test(E)){e.next=17;break}C(y({type:"error",header:void 0,content:"Uuden salasanan tulee olla 6-12 merkki\xe4 pitk\xe4 ja siin\xe4 oltava v\xe4hint\xe4\xe4n yksi kirjain, yksi numero ja yksi erikoismerkki.",timeout:3.5})),e.next=29;break;case 17:if(E===j){e.next=21;break}C(y({type:"error",header:void 0,content:"Salasana ja sen toisto eiv\xe4t vastaa toisiaan.",timeout:3.5})),e.next=29;break;case 21:if(E!==s){e.next=25;break}C(y({type:"error",header:void 0,content:"Uusi salasana on sama kuin nykyinen.",timeout:3.5})),e.next=29;break;case 25:return e.next=27,x.updateUser({user:{password:E}});case 27:e.sent?(C(y({type:"info",header:void 0,content:"Salasana vaihdettu onnistuneesti.",timeout:3.5})),m(""),h(""),w("")):C(y({type:"error",header:void 0,content:"Palvelinvirhe! Salasanan vaihto ep\xe4onnistui. Yrit\xe4 my\xf6hemmin uudelleen.",timeout:3.5}));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(fe.a,{closeIcon:!0,onClose:function(){l(!1),m(""),h(""),w(""),C(O())},onOpen:function(){return l(!0)},open:i,size:"tiny",closeOnDimmerClick:!1,closeOnEscape:!1,trigger:r.a.createElement("div",{className:"data-row",onClick:function(){return C(O())}},"Vaihda salasana")},r.a.createElement(fe.a.Header,null,"Vaihda salasana"),r.a.createElement(fe.a.Content,null,r.a.createElement(W.a,{textAlign:"center",verticalAlign:"top"},r.a.createElement(W.a.Column,{style:{maxWidth:400}},r.a.createElement(Q.a,{raised:!0},r.a.createElement("div",null,r.a.createElement("div",{className:"row-label"},"Nykyinen salasana:"),r.a.createElement(ve.a,{className:"change-pwd-input",name:"currentPwd",type:"password",value:s,onChange:function(e){return m(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("div",{className:"row-label"},"Uusi salasana:"),r.a.createElement(ve.a,{className:"change-pwd-input",name:"newPwd",type:"password",value:E,onChange:function(e){return h(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("div",{className:"row-label"},"Toista uusi salasana:"),r.a.createElement(ve.a,{className:"change-pwd-input",name:"confirmPwd",type:"password",value:j,onChange:function(e){return w(e.target.value)}})),N?r.a.createElement(ae,null):null)))),r.a.createElement(fe.a.Actions,null,r.a.createElement(X.a,{content:"Peruuta",color:"black",icon:"cancel",onClick:function(){C(O()),m(""),h(""),w(""),l(!1)}}),r.a.createElement(X.a,{content:"Tallenna",icon:"checkmark",onClick:S,positive:!0,disabled:""===s&&""===E&&""===j})))},Ae=(a(499),function(){var e=Object(n.useState)(!1),t=Object($.a)(e,2),a=t[0],i=t[1],l=Object(n.useState)(!1),o=Object($.a)(l,2),u=o[0],s=o[1],m=Object(c.c)((function(e){return e.note})),d=Object(c.b)();Object(n.useEffect)((function(){m||s(!1)}),[m]);return r.a.createElement(fe.a,{closeIcon:!0,onClose:function(){i(!1),d(O())},onOpen:function(){return i(!0)},open:a,size:"tiny",closeOnDimmerClick:!1,closeOnEscape:!1,trigger:r.a.createElement("div",{className:"data-row",onClick:function(){return d(O())}},"Poista tunnus")},r.a.createElement(fe.a.Header,null,"Poista k\xe4ytt\xe4j\xe4tunnus"),r.a.createElement(fe.a.Content,null,r.a.createElement(W.a,{textAlign:"center",verticalAlign:"top"},r.a.createElement(W.a.Column,null,r.a.createElement(ee.a,{icon:!0,color:"red"},r.a.createElement(te.a,{name:"warning sign"}),r.a.createElement(ee.a.Content,{style:{textAlign:"left"}},r.a.createElement(ee.a.Header,null,"Varoitus!"),"Oletko varma, ett\xe4 haluat poistaa k\xe4ytt\xe4j\xe4tunnuksesi ja kaikki siihen liitetyt ajoneuvot ja niiden tankkaukset?")),m?r.a.createElement(ae,null):null))),r.a.createElement(fe.a.Actions,null,r.a.createElement(X.a,{color:"black",content:"Peruuta",icon:"cancel",onClick:function(){i(!1)},disabled:u}),r.a.createElement(X.a,{color:"red",content:"Poista",icon:"trash alternate",onClick:function(){s(!0),d(function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.removeUser();case 3:t(y({type:"info",header:void 0,content:"K\xe4ytt\xe4j\xe4tunnus poistettu onnistuneesti.",timeout:3.5})),j(),setTimeout((function(){t(P())}),3500),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t(y({type:"error",header:void 0,content:"Odottamaton virhe k\xe4ytt\xe4j\xe4tunnuksen poistossa. Yrit\xe4 my\xf6hemmin uudelleen.",timeout:3.5}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())},disabled:u})))}),Ie=function(e){var t=e.user,a=Object(c.c)((function(e){return e.note})),i=Object(c.c)((function(e){return e.users})),l=Object(c.b)();return Object(n.useEffect)((function(){0===i.length&&0!==Object.keys(t).length&&l(function(){var e=Object(v.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.getSimpleUserList();case 3:a=e.sent,t({type:"INIT_USERS_LIST",data:a}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("usersReducer, getSimpleUserList error:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[i,t,l]),t?r.a.createElement("div",null,r.a.createElement(W.a,{textAlign:"center",verticalAlign:"top"},r.a.createElement(W.a.Column,{style:{maxWidth:350}},r.a.createElement(J.a,{as:"h2",color:"orange",textAlign:"center"},"Omat tiedot"),r.a.createElement(Q.a,{raised:!0},r.a.createElement("div",{className:"my-details-row"},r.a.createElement("div",{className:"row-label"},"Nimi:"),r.a.createElement("div",null,t.name)),r.a.createElement("div",{className:"my-details-row"},r.a.createElement("div",{className:"row-label"},"K\xe4ytt\xe4j\xe4tunnus:"),r.a.createElement("div",null,t.username)),r.a.createElement(se.a,null),r.a.createElement("div",{className:"my-details-row"},r.a.createElement("div",{className:"my-details-sub-row"},r.a.createElement(Te,{user:t}),r.a.createElement(Ae,null))),r.a.createElement(se.a,null),r.a.createElement("div",{className:"my-details-row"},r.a.createElement("div",{className:"row-label"},"Ajoneuvot:"),r.a.createElement(Se,{user:t,users:i}),r.a.createElement("div",{className:"my-details-row"},r.a.createElement(xe,{user:t,users:i}))),a?r.a.createElement(ae,null):null)))):null},_e=function(){var e=Object(c.c)((function(e){return e.user})),t=Object(c.c)((function(e){return e.navi})),a=Object(c.b)();return Object(n.useEffect)((function(){0===Object.keys(e).length&&a(function(){var e=Object(v.a)(f.a.mark((function e(t){var a,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=window.localStorage.getItem("loggedFTAUser"))&&(n=JSON.parse(a),g.setToken(n),r=Object(p.a)(n),t((r.id,function(){var e=Object(v.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.getUserById();case 3:a=e.sent,t({type:"INIT_USER",data:a}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("userReducer, getUser error:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e,a]),r.a.createElement("div",null,0!==Object.keys(e).length?r.a.createElement(le,{userName:e.name}):null,0===Object.keys(e).length?r.a.createElement(Y.a,{to:"/login"}):r.a.createElement(Y.a,{to:t}),r.a.createElement(Y.d,null,r.a.createElement(Y.b,{path:"/login"},r.a.createElement(re,null)),r.a.createElement(Y.b,{path:"/register"},r.a.createElement(ue,null)),r.a.createElement(Y.b,{path:"/my-details"},r.a.createElement(Ie,{user:e})),r.a.createElement(Y.b,{path:"/refueling-list"},r.a.createElement(je,{user:e}))))},Re=(a(500),function(){return r.a.createElement(_e,null)});l.a.render(r.a.createElement(o.a,null,r.a.createElement(c.a,{store:B},r.a.createElement(Re,null))),document.getElementById("root"))}},[[292,1,2]]]);
//# sourceMappingURL=main.e35fde97.chunk.js.map